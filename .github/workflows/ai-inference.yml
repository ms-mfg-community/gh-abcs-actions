---
name: 08-1. AI Inference

on:
  push:
    branches:
      - "feature/**"
  pull_request:
    branches: [main]
  workflow_dispatch:

permissions:
  models: read

jobs:
  inference:
    name: AI Inference
    runs-on: ubuntu-latest
    steps:
      - name: Placeholder
        id: ai
        run: echo "Add AI inference steps"

      - name: Display Response
        run: |
          cat <<'EOF'
          ${{ steps.ai.outputs.response }}
          EOF

  # Optional: MCP Integration Demo (requires PAT)
  # This job only runs if ENABLE_MCP_DEMO variable is set to 'true'
  mcp-demo:
    name: MCP Demo (Optional)
    runs-on: ubuntu-latest
    if: ${{ vars.ENABLE_MCP_DEMO == 'true' }}
    steps:
      - name: Run AI with Repository Context
        id: mcp-ai
        uses: actions/ai-inference@v1
        with:
          prompt: |
            You have access to this repository's context via MCP.
            Please list the open issues in this repository, including their
            numbers and titles. If there are no open issues, say so.
          max-tokens: 500
          enable-github-mcp: true
          github-mcp-token: ${{ secrets.GH_MCP_TOKEN }}
          github-mcp-toolsets: repos,issues,pull_requests

      - name: Display MCP Response
        run: |
          echo "=== AI Response with Repository Context ==="
          echo "${{ steps.mcp-ai.outputs.response }}"
